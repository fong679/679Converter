<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Converter - Fast & Accurate Metric Conversions</title>
    <meta name="description" content="Convert metrics instantly - length, area, volume, speed, data, and more. No registration required.">
    <link rel="canonical" href="https://fong679.github.io/679Converter/">
    
    <!-- Favicon SVG -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%236366f1;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23ec4899;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23grad)'/%3E%3Cpath d='M30 35 L45 50 L30 65' stroke='white' stroke-width='6' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3Cpath d='M70 35 L55 50 L70 65' stroke='white' stroke-width='6' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="679Converter">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --bg-primary: #fafafa;
            --bg-secondary: #f5f5f5;
            --bg-card: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #6b7280;
            --accent: #2563eb;
            --accent-hover: #1d4ed8;
            --border: #e5e7eb;
            --shadow: rgba(0, 0, 0, 0.05);
            --glow: rgba(37, 99, 235, 0.12);
            --pattern-opacity: 0.02;
        }
        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent: #38bdf8;
            --accent-hover: #0ea5e9;
            --border: #334155;
            --shadow: rgba(0, 0, 0, 0.5);
            --glow: rgba(56, 189, 248, 0.25);
            --pattern-opacity: 0.03;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: var(--pattern-opacity);
            background-image: 
                radial-gradient(circle at 20% 50%, var(--accent) 1px, transparent 1px),
                radial-gradient(circle at 80% 80%, var(--accent) 1px, transparent 1px),
                radial-gradient(circle at 40% 20%, var(--accent) 1px, transparent 1px);
            background-size: 50px 50px, 80px 80px, 60px 60px;
            background-position: 0 0, 40px 40px, 20px 20px;
        }
        header {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.75rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent), #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .logo-icon {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .logo-icon svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 4px 12px var(--glow));
        }
        .theme-toggle {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 50px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-primary);
            font-weight: 600;
        }
        .theme-toggle:hover {
            transform: scale(1.05);
            border-color: var(--accent);
            box-shadow: 0 0 20px var(--glow);
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        .categories {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.25rem;
            margin: 2rem 0;
        }
        .category-card {
            flex: 0 1 180px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--accent), #06b6d4);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }
        .category-card:hover::before {
            opacity: 0.1;
        }
        .category-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
            box-shadow: 0 8px 20px var(--glow);
        }
        .category-card.active {
            border-color: var(--accent);
            background: linear-gradient(135deg, var(--accent), #06b6d4);
            color: white;
            box-shadow: 0 8px 16px var(--glow);
        }
        .category-card.active .category-icon,
        .category-card.active .category-name {
            position: relative;
            z-index: 1;
        }
        .category-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            position: relative;
            z-index: 1;
        }
        .category-name {
            font-weight: 600;
            font-size: 1rem;
            position: relative;
            z-index: 1;
        }
        .converter-section {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 2.5rem;
            margin: 2rem 0;
            box-shadow: 0 2px 8px var(--shadow);
            display: none;
        }
        .converter-section.active {
            display: block;
            animation: slideIn 0.4s ease;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .converter-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-align: center;
            background: linear-gradient(135deg, var(--accent), #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .input-wrapper {
            flex: 1;
            min-width: 200px;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        input[type="number"],
        select {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1.125rem;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 4px var(--glow);
        }
        .swap-button {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--accent), #06b6d4);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px var(--glow);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .swap-button:hover {
            transform: scale(1.05);
        }
        .swap-button svg {
            width: 24px;
            height: 24px;
            transition: transform 0.3s ease;
        }
        .swap-button:hover svg {
            transform: rotate(180deg);
        }
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.25rem;
            margin-top: 2rem;
        }
        .result-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
        }
        .result-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent);
            box-shadow: 0 4px 12px var(--shadow);
        }
        .result-unit {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            word-break: break-all;
            margin-bottom: 0.75rem;
        }
        .copy-button {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }
        .copy-button:hover {
            background: var(--accent-hover);
            transform: scale(1.02);
        }
        .copy-button.copied {
            background: #10b981;
        }
        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            border-top: 1px solid var(--border);
            margin-top: 4rem;
        }
        .no-selection {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }
        .no-selection h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        @media (max-width: 768px) {
            header {
                padding: 1rem;
            }
            .logo {
                font-size: 1.25rem;
            }
            .logo-icon {
                width: 35px;
                height: 35px;
            }
            .container {
                padding: 1rem;
            }
            .categories {
                gap: 0.75rem;
            }
            .category-card {
                flex: 0 1 140px;
            }
            .converter-section {
                padding: 1.5rem;
            }
            .input-group {
                flex-direction: column;
            }
            .swap-button {
                width: 100%;
            }
        }
        /* ‚îÄ‚îÄ Currency styles ‚îÄ‚îÄ */
        .currency-live-badge {
            display: inline-block;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            font-size: 0.8rem;
            font-weight: 700;
            padding: 0.35rem 0.9rem;
            border-radius: 50px;
            margin-bottom: 1.75rem;
            letter-spacing: 0.04em;
        }
        .currency-result-main {
            background: linear-gradient(135deg, var(--accent), #06b6d4);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 1rem;
            color: white;
            min-height: 80px;
        }
        .currency-main-from {
            font-size: 1.4rem;
            font-weight: 600;
            opacity: 0.9;
        }
        .currency-equals {
            font-size: 1.2rem;
            opacity: 0.7;
            margin: 0.25rem 0;
        }
        .currency-main-to {
            font-size: 2.2rem;
            font-weight: 800;
            line-height: 1.1;
        }
        .currency-rate-note {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-top: 0.5rem;
        }
        .currency-status {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            text-align: center;
        }
        .highlight-card {
            border-color: var(--accent) !important;
            box-shadow: 0 0 0 3px var(--glow);
        }

        /* ‚îÄ‚îÄ Skeleton loading ‚îÄ‚îÄ */
        @keyframes shimmer {
            0% { background-position: -400px 0; }
            100% { background-position: 400px 0; }
        }
        .skeleton {
            background: linear-gradient(90deg,
                var(--bg-secondary) 25%,
                var(--border) 50%,
                var(--bg-secondary) 75%);
            background-size: 400px 100%;
            animation: shimmer 1.4s infinite linear;
            border-radius: 8px;
        }
        .skeleton-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
        }
        .skeleton-line {
            height: 14px;
            margin-bottom: 0.75rem;
        }
        .skeleton-value {
            height: 32px;
            margin-bottom: 1rem;
            width: 70%;
        }
        .skeleton-btn {
            height: 36px;
            border-radius: 8px;
        }

        /* ‚îÄ‚îÄ Number count-up animation ‚îÄ‚îÄ */
        .result-value {
            transition: opacity 0.15s ease;
        }
        .result-value.counting {
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div class="background-pattern"></div>
    
    <header>
        <div class="logo">
            <div class="logo-icon">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#2563eb;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#06b6d4;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <rect width="100" height="100" rx="20" fill="url(#logoGrad)"/>
                    <path d="M30 35 L45 50 L30 65" stroke="white" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    <path d="M70 35 L55 50 L70 65" stroke="white" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                </svg>
            </div>
            <span>679Converter</span>
        </div>
        <button class="theme-toggle" onclick="toggleTheme()">
            <span id="theme-icon">üåô</span>
            <span id="theme-text">Dark</span>
        </button>
    </header>
    <div class="container">
        <div class="categories" id="categories"></div>
        
        <div id="converter-container"></div>
        <div class="no-selection" id="no-selection">
            <h2>üöÄ Select a Category to Start Converting</h2>
            <p>Choose any conversion type above to begin</p>
        </div>
    </div>
    <footer>
        <p>&copy; 2026 679Converter. All conversions performed client-side. No data stored.</p>
    </footer>
    <script>
        const conversions = {
            length: {
                name: 'Length',
                icon: 'üìè',
                units: {
                    meter: { name: 'Meters', factor: 1 },
                    kilometer: { name: 'Kilometers', factor: 0.001 },
                    centimeter: { name: 'Centimeters', factor: 100 },
                    millimeter: { name: 'Millimeters', factor: 1000 },
                    mile: { name: 'Miles', factor: 0.000621371 },
                    yard: { name: 'Yards', factor: 1.09361 },
                    foot: { name: 'Feet', factor: 3.28084 },
                    inch: { name: 'Inches', factor: 39.3701 }
                }
            },
            area: {
                name: 'Area',
                icon: '‚¨ú',
                units: {
                    square_meter: { name: 'Square Meters', factor: 1 },
                    square_kilometer: { name: 'Square Kilometers', factor: 0.000001 },
                    square_centimeter: { name: 'Square Centimeters', factor: 10000 },
                    square_mile: { name: 'Square Miles', factor: 3.861e-7 },
                    square_yard: { name: 'Square Yards', factor: 1.19599 },
                    square_foot: { name: 'Square Feet', factor: 10.7639 },
                    acre: { name: 'Acres', factor: 0.000247105 },
                    hectare: { name: 'Hectares', factor: 0.0001 }
                }
            },
            volume: {
                name: 'Volume',
                icon: 'üßä',
                units: {
                    liter: { name: 'Liters', factor: 1 },
                    milliliter: { name: 'Milliliters', factor: 1000 },
                    cubic_meter: { name: 'Cubic Meters', factor: 0.001 },
                    gallon_us: { name: 'Gallons (US)', factor: 0.264172 },
                    gallon_uk: { name: 'Gallons (UK)', factor: 0.219969 },
                    quart: { name: 'Quarts', factor: 1.05669 },
                    pint: { name: 'Pints', factor: 2.11338 },
                    cup: { name: 'Cups', factor: 4.22675 },
                    fluid_ounce: { name: 'Fluid Ounces', factor: 33.814 }
                }
            },
            weight: {
                name: 'Weight/Mass',
                icon: '‚öñÔ∏è',
                units: {
                    kilogram: { name: 'Kilograms', factor: 1 },
                    gram: { name: 'Grams', factor: 1000 },
                    milligram: { name: 'Milligrams', factor: 1000000 },
                    pound: { name: 'Pounds', factor: 2.20462 },
                    ounce: { name: 'Ounces', factor: 35.274 },
                    ton_metric: { name: 'Metric Tons', factor: 0.001 },
                    ton_us: { name: 'US Tons', factor: 0.00110231 },
                    stone: { name: 'Stones', factor: 0.157473 }
                }
            },
            temperature: {
                name: 'Temperature',
                icon: 'üå°Ô∏è',
                units: {
                    celsius: { name: 'Celsius' },
                    fahrenheit: { name: 'Fahrenheit' },
                    kelvin: { name: 'Kelvin' }
                },
                convert: function(value, from, to) {
                    let celsius;
                    if (from === 'celsius') celsius = value;
                    else if (from === 'fahrenheit') celsius = (value - 32) * 5/9;
                    else if (from === 'kelvin') celsius = value - 273.15;
                    
                    if (to === 'celsius') return celsius;
                    else if (to === 'fahrenheit') return celsius * 9/5 + 32;
                    else if (to === 'kelvin') return celsius + 273.15;
                }
            },
            speed: {
                name: 'Speed',
                icon: 'üöÑ',
                units: {
                    meter_per_second: { name: 'Meters/Second', factor: 1 },
                    kilometer_per_hour: { name: 'Kilometers/Hour', factor: 3.6 },
                    mile_per_hour: { name: 'Miles/Hour', factor: 2.23694 },
                    foot_per_second: { name: 'Feet/Second', factor: 3.28084 },
                    knot: { name: 'Knots', factor: 1.94384 }
                }
            },
            data: {
                name: 'Data Storage',
                icon: 'üíæ',
                units: {
                    byte: { name: 'Bytes', factor: 1 },
                    kilobyte: { name: 'Kilobytes (KB)', factor: 1/1024 },
                    megabyte: { name: 'Megabytes (MB)', factor: 1/(1024*1024) },
                    gigabyte: { name: 'Gigabytes (GB)', factor: 1/(1024*1024*1024) },
                    terabyte: { name: 'Terabytes (TB)', factor: 1/(1024*1024*1024*1024) },
                    bit: { name: 'Bits', factor: 8 },
                    kilobit: { name: 'Kilobits (Kb)', factor: 8/1024 },
                    megabit: { name: 'Megabits (Mb)', factor: 8/(1024*1024) }
                }
            },
            time: {
                name: 'Time',
                icon: '‚è±Ô∏è',
                units: {
                    second: { name: 'Seconds', factor: 1 },
                    minute: { name: 'Minutes', factor: 1/60 },
                    hour: { name: 'Hours', factor: 1/3600 },
                    day: { name: 'Days', factor: 1/86400 },
                    week: { name: 'Weeks', factor: 1/604800 },
                    month: { name: 'Months (30 days)', factor: 1/2592000 },
                    year: { name: 'Years (365 days)', factor: 1/31536000 }
                }
            },
            energy: {
                name: 'Energy',
                icon: '‚ö°',
                units: {
                    joule: { name: 'Joules', factor: 1 },
                    kilojoule: { name: 'Kilojoules', factor: 0.001 },
                    calorie: { name: 'Calories', factor: 0.239006 },
                    kilocalorie: { name: 'Kilocalories', factor: 0.000239006 },
                    watt_hour: { name: 'Watt-hours', factor: 0.000277778 },
                    kilowatt_hour: { name: 'Kilowatt-hours', factor: 2.77778e-7 },
                    btu: { name: 'BTU', factor: 0.000947817 }
                }
            },
            pressure: {
                name: 'Pressure',
                icon: 'üîò',
                units: {
                    pascal: { name: 'Pascals', factor: 1 },
                    kilopascal: { name: 'Kilopascals', factor: 0.001 },
                    bar: { name: 'Bars', factor: 0.00001 },
                    psi: { name: 'PSI', factor: 0.000145038 },
                    atmosphere: { name: 'Atmospheres', factor: 9.86923e-6 },
                    mmhg: { name: 'mmHg', factor: 0.00750062 }
                }
            }
        };
        const allCategories = { ...conversions, currency: { name: 'Currency', icon: 'üí±' } };
        // Currency is handled separately (real-time)
        let currentCategory = null;
        let currentFromUnit = null;
        let currentToUnit = null;
        
        // ‚îÄ‚îÄ Currency live rates ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // Only currencies officially supported by the Frankfurter API
        const CURRENCY_LIST = {
            AUD: 'Australian Dollar', BGN: 'Bulgarian Lev', BRL: 'Brazilian Real',
            CAD: 'Canadian Dollar', CHF: 'Swiss Franc', CNY: 'Chinese Yuan',
            CZK: 'Czech Koruna', DKK: 'Danish Krone', EUR: 'Euro',
            GBP: 'British Pound', HKD: 'Hong Kong Dollar', HUF: 'Hungarian Forint',
            IDR: 'Indonesian Rupiah', ILS: 'Israeli Shekel', INR: 'Indian Rupee',
            ISK: 'Icelandic Krona', JPY: 'Japanese Yen', KRW: 'South Korean Won',
            MXN: 'Mexican Peso', MYR: 'Malaysian Ringgit', NOK: 'Norwegian Krone',
            NZD: 'New Zealand Dollar', PHP: 'Philippine Peso', PLN: 'Polish Zloty',
            RON: 'Romanian Leu', SEK: 'Swedish Krona', SGD: 'Singapore Dollar',
            THB: 'Thai Baht', TRY: 'Turkish Lira', USD: 'US Dollar',
            ZAR: 'South African Rand',
        };
        let cachedRates = null;   // { base, rates, timestamp }
        let currencyFrom = 'USD';
        let currencyTo = 'EUR';
        
        async function fetchRates(base) {
            // Returns rates relative to `base`
            const url = `https://api.frankfurter.app/latest?from=${base}`;
            const res = await fetch(url);
            if (!res.ok) throw new Error('Rate fetch failed');
            return await res.json();
        }
        
        async function renderCurrencyConverter() {
            const container = document.getElementById('converter-container');
            container.innerHTML = `
                <div class="converter-section active">
                    <h2 class="converter-title">üí± Currency Converter</h2>
                    <div class="currency-live-badge">üü¢ Live Rates via Frankfurter</div>
                    <div class="input-group">
                        <div class="input-wrapper">
                            <label>From</label>
                            <select id="currency-from" onchange="onCurrencyChange()">
                                ${Object.entries(CURRENCY_LIST).map(([code, name]) =>
                                    `<option value="${code}" ${code === currencyFrom ? 'selected' : ''}>${code} ‚Äì ${name}</option>`
                                ).join('')}
                            </select>
                        </div>
                        <div class="input-wrapper">
                            <label>Amount</label>
                            <input type="number" id="currency-amount" placeholder="Enter amount"
                                   oninput="convertCurrency()" step="any" value="1" min="0">
                        </div>
                        <button class="swap-button" onclick="swapCurrency()" title="Swap currencies">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="17 1 21 5 17 9"></polyline>
                                <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                                <polyline points="7 23 3 19 7 15"></polyline>
                                <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                            </svg>
                        </button>
                        <div class="input-wrapper">
                            <label>To</label>
                            <select id="currency-to" onchange="onCurrencyChange()">
                                ${Object.entries(CURRENCY_LIST).map(([code, name]) =>
                                    `<option value="${code}" ${code === currencyTo ? 'selected' : ''}>${code} ‚Äì ${name}</option>`
                                ).join('')}
                            </select>
                        </div>
                    </div>
                    <div id="currency-result-main" class="currency-result-main"></div>
                    <div id="currency-status" class="currency-status">Fetching live rates‚Ä¶</div>
                    <div class="results-grid" id="currency-results-grid"></div>
                </div>
            `;
            document.getElementById('no-selection').style.display = 'none';
            await loadAndConvertCurrency();
        }
        
        async function loadAndConvertCurrency() {
            const statusEl = document.getElementById('currency-status');
            const mainEl   = document.getElementById('currency-result-main');
            if (!mainEl) return;
            
            currencyFrom = document.getElementById('currency-from')?.value || currencyFrom;
            currencyTo   = document.getElementById('currency-to')?.value   || currencyTo;
            const amount = parseFloat(document.getElementById('currency-amount')?.value) || 1;
            
            try {
                if (statusEl) statusEl.textContent = 'Fetching live rates‚Ä¶';
                // Show skeleton cards while fetching
                showSkeletons('currency-results-grid', 12);
                const data = await fetchRates(currencyFrom);
                cachedRates = data;
                
                // Main result
                const rate = data.rates[currencyTo];
                const converted = amount * rate;
                if (mainEl) {
                    mainEl.innerHTML = `
                        <div class="currency-main-from">${amount.toLocaleString()} ${currencyFrom}</div>
                        <div class="currency-equals">=</div>
                        <div class="currency-main-to">${converted.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:4})} ${currencyTo}</div>
                        <div class="currency-rate-note">1 ${currencyFrom} = ${rate.toLocaleString(undefined, {minimumFractionDigits:4, maximumFractionDigits:6})} ${currencyTo}</div>
                    `;
                }
                
                if (statusEl) {
                    const d = new Date(data.date);
                    statusEl.innerHTML = `‚úÖ Rates as of <strong>${data.date}</strong> ¬∑ Source: Frankfurter / ECB`;
                }
                
                // All-currencies grid
                const grid = document.getElementById('currency-results-grid');
                if (grid) {
                    grid.innerHTML = '';
                    Object.entries(data.rates).forEach(([code, r]) => {
                        if (!CURRENCY_LIST[code]) return;
                        const val = amount * r;
                        const card = document.createElement('div');
                        card.className = 'result-card' + (code === currencyTo ? ' highlight-card' : '');
                        card.innerHTML = `
                            <div class="result-unit">${code} ¬∑ ${CURRENCY_LIST[code]}</div>
                            <div class="result-value" data-target="${val}" data-exp="false">0</div>
                            <button class="copy-button" onclick="copyToClipboard('${val.toFixed(4)}', this)">üìã Copy</button>
                        `;
                        grid.appendChild(card);
                    });
                    // Trigger count-up on currency cards
                    grid.querySelectorAll('.result-value[data-target]').forEach(el => {
                        const target = parseFloat(el.dataset.target);
                        countUp(el, target, false);
                    });
                }
            } catch (e) {
                if (statusEl) statusEl.textContent = '‚ö†Ô∏è Could not fetch rates. Check your connection.';
                if (mainEl)   mainEl.textContent = '';
            }
        }
        
        function onCurrencyChange() {
            currencyFrom = document.getElementById('currency-from').value;
            currencyTo   = document.getElementById('currency-to').value;
            loadAndConvertCurrency();
        }
        function convertCurrency() { loadAndConvertCurrency(); }
        function swapCurrency() {
            const tmp = currencyFrom;
            currencyFrom = currencyTo;
            currencyTo = tmp;
            document.getElementById('currency-from').value = currencyFrom;
            document.getElementById('currency-to').value   = currencyTo;
            loadAndConvertCurrency();
        }
        // ‚îÄ‚îÄ End currency ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function renderCategories() {
            const container = document.getElementById('categories');
            container.innerHTML = '';
            
            Object.keys(allCategories).forEach(key => {
                const category = allCategories[key];
                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `
                    <div class="category-icon">${category.icon}</div>
                    <div class="category-name">${category.name}</div>
                `;
                card.onclick = () => selectCategory(key);
                container.appendChild(card);
            });
        }
        function selectCategory(categoryKey) {
            currentCategory = categoryKey;
            
            document.querySelectorAll('.category-card').forEach(card => {
                card.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            if (categoryKey === 'currency') {
                renderCurrencyConverter();
                return;
            }
            
            const units = Object.keys(conversions[categoryKey].units);
            currentFromUnit = units[0];
            currentToUnit = units[1] || units[0];
            
            renderConverter();
            document.getElementById('no-selection').style.display = 'none';
        }
        function renderConverter() {
            const container = document.getElementById('converter-container');
            const category = conversions[currentCategory];
            const units = Object.keys(category.units);
            
            container.innerHTML = `
                <div class="converter-section active">
                    <h2 class="converter-title">${category.icon} ${category.name} Converter</h2>
                    
                    <div class="input-group">
                        <div class="input-wrapper">
                            <label>From</label>
                            <select id="from-unit" onchange="updateFromUnit()">
                                ${units.map(unit => `
                                    <option value="${unit}" ${unit === currentFromUnit ? 'selected' : ''}>
                                        ${category.units[unit].name}
                                    </option>
                                `).join('')}
                            </select>
                        </div>
                        
                        <div class="input-wrapper">
                            <label>Value</label>
                            <input type="number" id="input-value" placeholder="Enter value" 
                                   oninput="convert()" step="any" value="1">
                        </div>
                        
                        <button class="swap-button" onclick="swapUnits()" title="Swap units">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="17 1 21 5 17 9"></polyline>
                                <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                                <polyline points="7 23 3 19 7 15"></polyline>
                                <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                            </svg>
                        </button>
                        
                        <div class="input-wrapper">
                            <label>To</label>
                            <select id="to-unit" onchange="updateToUnit()">
                                ${units.map(unit => `
                                    <option value="${unit}" ${unit === currentToUnit ? 'selected' : ''}>
                                        ${category.units[unit].name}
                                    </option>
                                `).join('')}
                            </select>
                        </div>
                    </div>
                    
                    <div class="results-grid" id="results"></div>
                </div>
            `;
            
            convert();
        }
        function updateFromUnit() {
            currentFromUnit = document.getElementById('from-unit').value;
            convert();
        }
        function updateToUnit() {
            currentToUnit = document.getElementById('to-unit').value;
            convert();
        }
        function swapUnits() {
            const temp = currentFromUnit;
            currentFromUnit = currentToUnit;
            currentToUnit = temp;
            renderConverter();
        }

        // Animate a number from 0 to target in ~400ms
        function countUp(el, target, isExponential) {
            const duration = 380;
            const steps = 24;
            const interval = duration / steps;
            let step = 0;
            el.classList.add('counting');
            const timer = setInterval(() => {
                step++;
                const progress = step / steps;
                // ease-out quad
                const eased = 1 - (1 - progress) * (1 - progress);
                const current = target * eased;
                el.textContent = isExponential
                    ? current.toExponential(4)
                    : formatNumber(current);
                if (step >= steps) {
                    clearInterval(timer);
                    el.textContent = isExponential ? target.toExponential(4) : formatNumber(target);
                    el.classList.remove('counting');
                }
            }, interval);
        }

        // Show skeleton cards in the results grid
        function showSkeletons(containerId, count) {
            const grid = document.getElementById(containerId);
            if (!grid) return;
            grid.innerHTML = '';
            for (let i = 0; i < count; i++) {
                grid.innerHTML += `
                    <div class="skeleton-card">
                        <div class="skeleton skeleton-line" style="width:55%"></div>
                        <div class="skeleton skeleton-value"></div>
                        <div class="skeleton skeleton-btn"></div>
                    </div>`;
            }
        }
        function convert() {
            const value = parseFloat(document.getElementById('input-value').value);
            if (isNaN(value)) {
                document.getElementById('results').innerHTML = '';
                return;
            }
            
            const category = conversions[currentCategory];
            const results = document.getElementById('results');
            results.innerHTML = '';
            
            // Show skeletons briefly before animating in
            const unitCount = Object.keys(category.units).length;
            results.innerHTML = '';
            Object.keys(category.units).forEach(unitKey => {
                let convertedValue;
                
                if (currentCategory === 'temperature') {
                    convertedValue = category.convert(value, currentFromUnit, unitKey);
                } else {
                    const fromFactor = category.units[currentFromUnit].factor;
                    const toFactor = category.units[unitKey].factor;
                    convertedValue = (value / fromFactor) * toFactor;
                }
                
                const card = document.createElement('div');
                card.className = 'result-card';
                const isExp = Math.abs(convertedValue) < 0.0001 && convertedValue !== 0
                           || Math.abs(convertedValue) > 1000000;
                card.innerHTML = `
                    <div class="result-unit">${category.units[unitKey].name}</div>
                    <div class="result-value" data-target="${convertedValue}" data-exp="${isExp}">0</div>
                    <button class="copy-button" onclick="copyToClipboard('${convertedValue}', this)">
                        üìã Copy
                    </button>
                `;
                results.appendChild(card);
            });
            // Trigger count-up on all freshly added result values
            results.querySelectorAll('.result-value[data-target]').forEach(el => {
                const target = parseFloat(el.dataset.target);
                const isExp = el.dataset.exp === 'true';
                countUp(el, target, isExp);
            });
        }
        function formatNumber(num) {
            if (Math.abs(num) < 0.0001 && num !== 0) {
                return num.toExponential(4);
            }
            if (Math.abs(num) > 1000000) {
                return num.toExponential(4);
            }
            return num.toFixed(6).replace(/\.?0+$/, '');
        }
        function copyToClipboard(value, button) {
            navigator.clipboard.writeText(value).then(() => {
                const originalText = button.innerHTML;
                button.innerHTML = '‚úì Copied!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.classList.remove('copied');
                }, 2000);
            });
        }
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const icon = document.getElementById('theme-icon');
            const text = document.getElementById('theme-text');
            
            if (newTheme === 'dark') {
                icon.textContent = 'üåô';
                text.textContent = 'Dark';
            } else {
                icon.textContent = '‚òÄÔ∏è';
                text.textContent = 'Light';
            }
        }
        
        // Initialize theme from localStorage
        (function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                const icon = document.getElementById('theme-icon');
                const text = document.getElementById('theme-text');
                if (savedTheme === 'dark') {
                    icon.textContent = 'üåô';
                    text.textContent = 'Dark';
                } else {
                    icon.textContent = '‚òÄÔ∏è';
                    text.textContent = 'Light';
                }
            }
        })();
        
        // Initialize
        renderCategories();
        
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => console.log('SW registered:', registration))
                    .catch(error => console.log('SW registration failed:', error));
            });
        }
    </script>
</body>
</html>
